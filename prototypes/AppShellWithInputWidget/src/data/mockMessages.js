import { subDays, subHours, subMinutes } from 'date-fns';
import { MESSAGE_TYPES, CONVERSATION_TYPES, MESSAGE_STATUS } from './messageTypes';

// Current user ID (matches the logged-in user)
export const CURRENT_USER_ID = 'current-user';

// Mock conversations
const mockConversations = [
  {
    id: 'conv-1',
    type: CONVERSATION_TYPES.DIRECT,
    name: 'Lena Weber',
    participants: [CURRENT_USER_ID, 'user-1'],
    avatar: 'https://images.unsplash.com/photo-1494790108377-be9c29b29330?w=100&h=100&fit=crop&crop=face',
    lastMessage: {
      content: 'Super, bis morgen dann! ðŸ™Œ',
      senderId: 'user-1',
      createdAt: subMinutes(new Date(), 5).toISOString(),
    },
    unreadCount: 2,
    isPinned: false,
    isMuted: false,
    createdAt: subDays(new Date(), 10).toISOString(),
    updatedAt: subMinutes(new Date(), 5).toISOString(),
  },
  {
    id: 'conv-2',
    type: CONVERSATION_TYPES.DIRECT,
    name: 'Max Schmidt',
    participants: [CURRENT_USER_ID, 'user-2'],
    avatar: 'https://images.unsplash.com/photo-1535713875002-d1d0cf377fde?w=100&h=100&fit=crop&crop=face',
    lastMessage: {
      content: 'Kannst du mir die Bohrmaschine nÃ¤chste Woche leihen?',
      senderId: 'user-2',
      createdAt: subHours(new Date(), 3).toISOString(),
    },
    unreadCount: 1,
    isPinned: true,
    isMuted: false,
    createdAt: subDays(new Date(), 15).toISOString(),
    updatedAt: subHours(new Date(), 3).toISOString(),
  },
  {
    id: 'conv-3',
    type: CONVERSATION_TYPES.GROUP,
    name: 'Community Garten Team',
    participants: [CURRENT_USER_ID, 'user-1', 'user-2', 'user-3'],
    avatar: 'https://images.unsplash.com/photo-1466692476868-aef1dfb1e735?w=100&h=100&fit=crop&crop=face',
    lastMessage: {
      content: 'Ich bringe morgen die Schaufeln mit',
      senderId: CURRENT_USER_ID,
      createdAt: subHours(new Date(), 5).toISOString(),
    },
    unreadCount: 0,
    isPinned: false,
    isMuted: false,
    createdAt: subDays(new Date(), 20).toISOString(),
    updatedAt: subHours(new Date(), 5).toISOString(),
  },
  {
    id: 'conv-4',
    type: CONVERSATION_TYPES.DIRECT,
    name: 'Julia Klein',
    participants: [CURRENT_USER_ID, 'user-3'],
    avatar: 'https://images.unsplash.com/photo-1580489944761-15a19d654956?w=100&h=100&fit=crop&crop=face',
    lastMessage: {
      content: 'Danke fÃ¼r die Info!',
      senderId: CURRENT_USER_ID,
      createdAt: subDays(new Date(), 1).toISOString(),
    },
    unreadCount: 0,
    isPinned: false,
    isMuted: false,
    createdAt: subDays(new Date(), 8).toISOString(),
    updatedAt: subDays(new Date(), 1).toISOString(),
  },
];

// Mock messages for each conversation
const mockMessages = {
  'conv-1': [
    {
      id: 'msg-1-1',
      conversationId: 'conv-1',
      senderId: 'user-1',
      content: 'Hey! Kommst du morgen auch zur Yoga-Session im Park?',
      type: MESSAGE_TYPES.TEXT,
      attachments: [],
      reactions: {},
      replyTo: null,
      isRead: true,
      isDelivered: true,
      createdAt: subMinutes(new Date(), 45).toISOString(),
      updatedAt: subMinutes(new Date(), 45).toISOString(),
      isEdited: false,
    },
    {
      id: 'msg-1-2',
      conversationId: 'conv-1',
      senderId: CURRENT_USER_ID,
      content: 'Ja klar! Freue mich schon drauf ðŸ˜Š',
      type: MESSAGE_TYPES.TEXT,
      attachments: [],
      reactions: { 'â¤ï¸': ['user-1'] },
      replyTo: null,
      isRead: true,
      isDelivered: true,
      createdAt: subMinutes(new Date(), 40).toISOString(),
      updatedAt: subMinutes(new Date(), 40).toISOString(),
      isEdited: false,
    },
    {
      id: 'msg-1-3',
      conversationId: 'conv-1',
      senderId: 'user-1',
      content: 'Hier ist der genaue Treffpunkt:',
      type: MESSAGE_TYPES.TEXT,
      attachments: [],
      reactions: {},
      replyTo: null,
      isRead: true,
      isDelivered: true,
      createdAt: subMinutes(new Date(), 35).toISOString(),
      updatedAt: subMinutes(new Date(), 35).toISOString(),
      isEdited: false,
    },
    {
      id: 'msg-1-4',
      conversationId: 'conv-1',
      senderId: 'user-1',
      content: '',
      type: MESSAGE_TYPES.IMAGE,
      attachments: [
        {
          id: 'att-1',
          type: 'image',
          url: 'https://images.unsplash.com/photo-1544367567-0f2fcb009e0b?w=500&q=80',
          name: 'park-location.jpg',
          size: 245678,
          mimeType: 'image/jpeg',
        },
      ],
      reactions: { 'ðŸ‘': [CURRENT_USER_ID] },
      replyTo: null,
      isRead: true,
      isDelivered: true,
      createdAt: subMinutes(new Date(), 30).toISOString(),
      updatedAt: subMinutes(new Date(), 30).toISOString(),
      isEdited: false,
    },
    {
      id: 'msg-1-5',
      conversationId: 'conv-1',
      senderId: CURRENT_USER_ID,
      content: 'Perfect! Soll ich meine Matte mitbringen oder hast du eine extra?',
      type: MESSAGE_TYPES.TEXT,
      attachments: [],
      reactions: {},
      replyTo: 'msg-1-4',
      isRead: true,
      isDelivered: true,
      createdAt: subMinutes(new Date(), 20).toISOString(),
      updatedAt: subMinutes(new Date(), 20).toISOString(),
      isEdited: false,
    },
    {
      id: 'msg-1-6',
      conversationId: 'conv-1',
      senderId: 'user-1',
      content: 'Bring deine eigene mit, wenn mÃ¶glich. Ich habe nur eine ðŸ˜…',
      type: MESSAGE_TYPES.TEXT,
      attachments: [],
      reactions: {},
      replyTo: null,
      isRead: false,
      isDelivered: true,
      createdAt: subMinutes(new Date(), 10).toISOString(),
      updatedAt: subMinutes(new Date(), 10).toISOString(),
      isEdited: false,
    },
    {
      id: 'msg-1-7',
      conversationId: 'conv-1',
      senderId: 'user-1',
      content: 'Super, bis morgen dann! ðŸ™Œ',
      type: MESSAGE_TYPES.TEXT,
      attachments: [],
      reactions: {},
      replyTo: null,
      isRead: false,
      isDelivered: true,
      createdAt: subMinutes(new Date(), 5).toISOString(),
      updatedAt: subMinutes(new Date(), 5).toISOString(),
      isEdited: false,
    },
  ],
  'conv-2': [
    {
      id: 'msg-2-1',
      conversationId: 'conv-2',
      senderId: 'user-2',
      content: 'Hi! Ich habe gesehen, dass du eine Bohrmaschine zum Verleih anbietest.',
      type: MESSAGE_TYPES.TEXT,
      attachments: [],
      reactions: {},
      replyTo: null,
      isRead: true,
      isDelivered: true,
      createdAt: subHours(new Date(), 4).toISOString(),
      updatedAt: subHours(new Date(), 4).toISOString(),
      isEdited: false,
    },
    {
      id: 'msg-2-2',
      conversationId: 'conv-2',
      senderId: CURRENT_USER_ID,
      content: 'Ja genau! Die ist noch verfÃ¼gbar.',
      type: MESSAGE_TYPES.TEXT,
      attachments: [],
      reactions: {},
      replyTo: null,
      isRead: true,
      isDelivered: true,
      createdAt: subHours(new Date(), 3).toISOString(),
      updatedAt: subHours(new Date(), 3).toISOString(),
      isEdited: false,
    },
    {
      id: 'msg-2-3',
      conversationId: 'conv-2',
      senderId: 'user-2',
      content: 'Kannst du mir die Bohrmaschine nÃ¤chste Woche leihen?',
      type: MESSAGE_TYPES.TEXT,
      attachments: [],
      reactions: {},
      replyTo: null,
      isRead: false,
      isDelivered: true,
      createdAt: subHours(new Date(), 3).toISOString(),
      updatedAt: subHours(new Date(), 3).toISOString(),
      isEdited: false,
    },
  ],
  'conv-3': [
    {
      id: 'msg-3-1',
      conversationId: 'conv-3',
      senderId: 'user-1',
      content: 'Hallo zusammen! Wann treffen wir uns morgen fÃ¼r das Gartenprojekt?',
      type: MESSAGE_TYPES.TEXT,
      attachments: [],
      reactions: {},
      replyTo: null,
      isRead: true,
      isDelivered: true,
      createdAt: subHours(new Date(), 8).toISOString(),
      updatedAt: subHours(new Date(), 8).toISOString(),
      isEdited: false,
    },
    {
      id: 'msg-3-2',
      conversationId: 'conv-3',
      senderId: 'user-2',
      content: 'Ich schlage 10 Uhr vor, dann haben wir den ganzen Tag Zeit',
      type: MESSAGE_TYPES.TEXT,
      attachments: [],
      reactions: { 'ðŸ‘': ['user-1', CURRENT_USER_ID] },
      replyTo: null,
      isRead: true,
      isDelivered: true,
      createdAt: subHours(new Date(), 7).toISOString(),
      updatedAt: subHours(new Date(), 7).toISOString(),
      isEdited: false,
    },
    {
      id: 'msg-3-3',
      conversationId: 'conv-3',
      senderId: 'user-3',
      content: 'Passt mir auch! Wer bringt Werkzeug mit?',
      type: MESSAGE_TYPES.TEXT,
      attachments: [],
      reactions: {},
      replyTo: null,
      isRead: true,
      isDelivered: true,
      createdAt: subHours(new Date(), 6).toISOString(),
      updatedAt: subHours(new Date(), 6).toISOString(),
      isEdited: false,
    },
    {
      id: 'msg-3-4',
      conversationId: 'conv-3',
      senderId: CURRENT_USER_ID,
      content: 'Ich bringe morgen die Schaufeln mit',
      type: MESSAGE_TYPES.TEXT,
      attachments: [],
      reactions: { 'ðŸ™': ['user-1', 'user-3'] },
      replyTo: 'msg-3-3',
      isRead: true,
      isDelivered: true,
      createdAt: subHours(new Date(), 5).toISOString(),
      updatedAt: subHours(new Date(), 5).toISOString(),
      isEdited: false,
    },
  ],
  'conv-4': [
    {
      id: 'msg-4-1',
      conversationId: 'conv-4',
      senderId: 'user-3',
      content: 'Hey! Hast du schon von dem neuen Community-Event gehÃ¶rt?',
      type: MESSAGE_TYPES.TEXT,
      attachments: [],
      reactions: {},
      replyTo: null,
      isRead: true,
      isDelivered: true,
      createdAt: subDays(new Date(), 1).toISOString(),
      updatedAt: subDays(new Date(), 1).toISOString(),
      isEdited: false,
    },
    {
      id: 'msg-4-2',
      conversationId: 'conv-4',
      senderId: CURRENT_USER_ID,
      content: 'Danke fÃ¼r die Info!',
      type: MESSAGE_TYPES.TEXT,
      attachments: [],
      reactions: {},
      replyTo: null,
      isRead: true,
      isDelivered: true,
      createdAt: subDays(new Date(), 1).toISOString(),
      updatedAt: subDays(new Date(), 1).toISOString(),
      isEdited: false,
    },
  ],
};

// Initialize messages in localStorage
export const initializeMessages = () => {
  if (!localStorage.getItem('conversations')) {
    localStorage.setItem('conversations', JSON.stringify(mockConversations));
  }

  if (!localStorage.getItem('messages')) {
    localStorage.setItem('messages', JSON.stringify(mockMessages));
  }
};

export { mockConversations, mockMessages };
